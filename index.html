<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Herramienta de Vaciado de Encuestas</title>
    <!-- Tailwind CSS para un diseño moderno -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React y Babel para la funcionalidad interactiva -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- SheetJS (xlsx) para la funcionalidad de Excel -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        /* Estilos personalizados para mejorar la experiencia */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f9fafb; /* bg-gray-50 */
            color: #1f2937; /* text-gray-800 */
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        /* Estilo para los inputs numéricos y las flechas */
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            opacity: 1;
            cursor: pointer;
        }

        /* Estilo para la tabla con scroll */
        .table-container {
            max-height: 70vh;
            overflow: auto;
        }
        
        /* Clases para el resaltado de celdas en foco */
        .cell-focus {
            outline: 2px solid #3b82f6; /* blue-500 */
            outline-offset: -2px;
            background-color: #eff6ff; /* blue-50 */
        }
        
        /* Animaciones suaves */
        .transition-all {
            transition: all 0.3s ease-in-out;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;

        // --- COMPONENTE PRINCIPAL DE LA APLICACIÓN ---
        function App() {
            const [view, setView] = useState('config');
            const [variablesConfig, setVariablesConfig] = useState([]);
            const [respondentsData, setRespondentsData] = useState([]);
            const [summaryData, setSummaryData] = useState([]);
            const [summaryMode, setSummaryMode] = useState('average');
            
            const dimensionsMap = useMemo(() => {
                let dimensionCounter = 1;
                let questionCounter = 1;
                const structuredDimensions = [];
                variablesConfig.forEach((variable) => {
                    variable.dimensions.forEach(dim => {
                         structuredDimensions.push({
                            id: dimensionCounter,
                            variableId: variable.id,
                            questions: dim.questions,
                            questionStartIndex: questionCounter
                        });
                        dimensionCounter++;
                        questionCounter += dim.questions;
                    });
                });
                return structuredDimensions;
            }, [variablesConfig]);

            useEffect(() => {
                if (respondentsData.length === 0) {
                    setSummaryData([]);
                    return;
                }

                const newSummaryData = respondentsData.map(respondent => {
                    const respondentSummary = {
                        respondentId: respondent.id,
                        variables: {},
                        dimensions: {}
                    };

                    // Calcular resúmenes por dimensión para este encuestado
                    dimensionsMap.forEach((dim) => {
                        let dimValues = [];
                        for (let q = 0; q < dim.questions; q++) {
                            const questionNumber = dim.questionStartIndex + q;
                            const key = `d${dim.id}_p${questionNumber}`;
                            const value = respondent[key];
                            if (value !== null && value !== undefined && value !== '') {
                                dimValues.push(parseFloat(value));
                            }
                        }

                        if (dimValues.length > 0) {
                            const sum = dimValues.reduce((acc, val) => acc + val, 0);
                            if (summaryMode === 'average') {
                                respondentSummary.dimensions[`dim_${dim.id}`] = (sum / dimValues.length).toFixed(2);
                            } else {
                                respondentSummary.dimensions[`dim_${dim.id}`] = sum.toFixed(2);
                            }
                        } else {
                            respondentSummary.dimensions[`dim_${dim.id}`] = 'N/A';
                        }
                    });

                    // Calcular resúmenes por variable para este encuestado
                    variablesConfig.forEach(variable => {
                        let varValues = [];
                        const variableDimensions = dimensionsMap.filter(d => d.variableId === variable.id);

                        variableDimensions.forEach(dim => {
                            for (let q = 0; q < dim.questions; q++) {
                                const questionNumber = dim.questionStartIndex + q;
                                const key = `d${dim.id}_p${questionNumber}`;
                                const value = respondent[key];
                                if (value !== null && value !== undefined && value !== '') {
                                    varValues.push(parseFloat(value));
                                }
                            }
                        });

                        if (varValues.length > 0) {
                            const sum = varValues.reduce((acc, val) => acc + val, 0);
                            if (summaryMode === 'average') {
                                respondentSummary.variables[`var_${variable.id}`] = (sum / varValues.length).toFixed(2);
                            } else {
                                respondentSummary.variables[`var_${variable.id}`] = sum.toFixed(2);
                            }
                        } else {
                            respondentSummary.variables[`var_${variable.id}`] = 'N/A';
                        }
                    });

                    return respondentSummary;
                });

                setSummaryData(newSummaryData);
            }, [respondentsData, dimensionsMap, summaryMode, variablesConfig]);

            const handleStartEditor = (config) => {
                setVariablesConfig(config);
                setRespondentsData([{ id: 1 }]);
                setView('editor');
            };
            
            const handleBackToConfig = () => {
                setView('config');
                setVariablesConfig([]);
                setRespondentsData([]);
                setSummaryData([]);
            };
            
            return (
                <div className="min-h-screen bg-gray-50 text-gray-800 p-4 sm:p-6 lg:p-8 fade-in">
                    {view === 'config' ? (
                        <ConfigurationScreen onStart={handleStartEditor} />
                    ) : (
                        <SurveyEditor
                            variablesConfig={variablesConfig}
                            dimensionsMap={dimensionsMap}
                            respondentsData={respondentsData}
                            setRespondentsData={setRespondentsData}
                            summaryData={summaryData}
                            summaryMode={summaryMode}
                            setSummaryMode={setSummaryMode}
                            onBackToConfig={handleBackToConfig}
                        />
                    )}
                </div>
            );
        }

        function ConfigurationScreen({ onStart }) {
            const [variables, setVariables] = useState([{ id: 1, dimensions: [{ questions: 3 }] }]);

            const handleNumVariablesChange = (e) => {
                const count = Math.max(1, parseInt(e.target.value) || 1);
                setVariables(currentVars => {
                    const newVars = [...currentVars];
                    while (newVars.length < count) {
                        newVars.push({ id: newVars.length + 1, dimensions: [{ questions: 3 }] });
                    }
                    return newVars.slice(0, count);
                });
            };
            
            const handleNumDimensionsChange = (varIndex, e) => {
                const count = Math.max(1, parseInt(e.target.value) || 1);
                setVariables(currentVars => {
                    const newVars = JSON.parse(JSON.stringify(currentVars));
                    const currentDims = newVars[varIndex].dimensions;
                    while (currentDims.length < count) {
                        currentDims.push({ questions: 3 });
                    }
                    newVars[varIndex].dimensions = currentDims.slice(0, count);
                    return newVars;
                });
            };
            
            const handleQuestionsChange = (varIndex, dimIndex, e) => {
                const count = Math.max(1, parseInt(e.target.value) || 1);
                setVariables(currentVars => {
                    const newVars = JSON.parse(JSON.stringify(currentVars));
                    newVars[varIndex].dimensions[dimIndex].questions = count;
                    return newVars;
                });
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                onStart(variables);
            };

            return (
                <div className="max-w-2xl mx-auto flex flex-col items-center justify-center min-h-[80vh]">
                    <div className="w-full bg-white p-8 rounded-xl shadow-lg border border-gray-200">
                        <div className="text-center mb-8">
                            <img src="logo_final.png" alt="Logo Institucional" className="h-12 w-auto mx-auto mb-4" />
                            <h1 className="text-3xl font-bold text-gray-900">Configuración de la Encuesta</h1>
                            <p className="text-gray-500 mt-2">Define la estructura de tus variables y dimensiones.</p>
                        </div>
                        <form onSubmit={handleSubmit} className="space-y-6">
                            <div>
                                <label htmlFor="numVariables" className="block text-sm font-medium text-gray-700 mb-2">
                                    ¿Cuántas variables tendrá la encuesta?
                                </label>
                                <input
                                    id="numVariables"
                                    type="number"
                                    min="1"
                                    value={variables.length}
                                    onChange={handleNumVariablesChange}
                                    className="w-full bg-gray-50 border-gray-300 text-gray-900 rounded-md p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"
                                />
                            </div>

                            <div className="space-y-4">
                                {variables.map((variable, varIndex) => (
                                    <div key={variable.id} className="p-4 border rounded-lg space-y-3 bg-gray-50">
                                        <h3 className="font-semibold text-lg">Variable {varIndex + 1}</h3>
                                        <div>
                                            <label htmlFor={`dims-var-${varIndex}`} className="block text-sm font-medium text-gray-700 mb-1">
                                                Número de Dimensiones
                                            </label>
                                            <input
                                                id={`dims-var-${varIndex}`}
                                                type="number"
                                                min="1"
                                                value={variable.dimensions.length}
                                                onChange={(e) => handleNumDimensionsChange(varIndex, e)}
                                                className="w-full bg-white border-gray-300 text-gray-900 rounded-md p-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                            />
                                        </div>
                                        {variable.dimensions.map((dim, dimIndex) => (
                                            <div key={dimIndex} className="flex items-center justify-between gap-4">
                                                <label htmlFor={`questions-var-${varIndex}-dim-${dimIndex}`} className="text-sm font-medium text-gray-600">
                                                    Preguntas en Dimensión {dimIndex + 1}
                                                </label>
                                                <input
                                                    id={`questions-var-${varIndex}-dim-${dimIndex}`}
                                                    type="number"
                                                    min="1"
                                                    value={dim.questions}
                                                    onChange={(e) => handleQuestionsChange(varIndex, dimIndex, e)}
                                                    className="w-24 bg-white border-gray-300 text-gray-900 rounded-md p-2 text-center focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                />
                                            </div>
                                        ))}
                                    </div>
                                ))}
                            </div>

                            <button
                                type="submit"
                                className="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition-all transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
                            >
                                Crear Tabla de Vaciado
                            </button>
                        </form>
                    </div>
                </div>
            );
        }

        function SurveyEditor({ variablesConfig, dimensionsMap, respondentsData, setRespondentsData, summaryData, summaryMode, setSummaryMode, onBackToConfig }) {
            const fileInputRef = useRef(null);
            const [showResetModal, setShowResetModal] = useState(false);
            const [respondentsToAdd, setRespondentsToAdd] = useState(1);

            const handleAddRespondents = () => {
                const numToAdd = Math.max(1, respondentsToAdd || 1);
                const lastId = respondentsData.length > 0 ? Math.max(...respondentsData.map(r => r.id)) : 0;
                const newRespondents = Array.from({ length: numToAdd }, (_, i) => ({ id: lastId + i + 1 }));
                setRespondentsData(prevData => [...prevData, ...newRespondents]);
            };

            const handleDeleteRespondent = (idToDelete) => {
                 setRespondentsData(prevData => prevData.filter(respondent => respondent.id !== idToDelete));
            };

            const handleDataChange = (respondentId, key, value) => {
                setRespondentsData(prevData => prevData.map(respondent => {
                    if (respondent.id === respondentId) {
                        const numericValue = value === '' ? '' : Math.max(0, parseFloat(value));
                        return { ...respondent, [key]: numericValue };
                    }
                    return respondent;
                }));
            };
            
            const handleFileUpload = (event) => {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        const sheetName = workbook.SheetNames[0];
                        const worksheet = workbook.Sheets[sheetName];
                        const json = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                        
                        if (json.length < 3) throw new Error("Formato de archivo inválido.");
                        
                        const headerKeys = json[2];
                        const parsedData = json.slice(3).map((row, index) => {
                            const respondent = { id: index + 1 };
                            headerKeys.forEach((key, i) => {
                                if (key && String(key).startsWith('d')) {
                                   respondent[key] = (row[i] !== null && row[i] !== undefined) ? Number(row[i]) : '';
                                }
                            });
                            return respondent;
                        });

                        setRespondentsData(parsedData);
                    } catch (error) {
                        console.error("Error al procesar el archivo:", error);
                    }
                };
                reader.readAsArrayBuffer(file);
                event.target.value = null; 
            };
            
            const handleDownloadExcel = () => {
                const columnKeys = dimensionsMap.flatMap(dim => {
                    return Array.from({length: dim.questions}, (_, i) => `d${dim.id}_p${dim.questionStartIndex + i}`);
                });

                const dataForSheet = respondentsData.map((respondent, index) => {
                    const row = { 'Encuestado #': index + 1 };
                    columnKeys.forEach(key => {
                        row[key] = respondent[key] !== undefined ? respondent[key] : '';
                    });
                    return row;
                });

                const ws = XLSX.utils.json_to_sheet(dataForSheet, { header: ['Encuestado #', ...columnKeys] });

                const merges = [];
                let colOffset = 1;
                variablesConfig.forEach(v => {
                    const questionsInVar = v.dimensions.reduce((acc, dim) => acc + dim.questions, 0);
                    if (questionsInVar > 1) merges.push({ s: { r: 0, c: colOffset }, e: { r: 0, c: colOffset + questionsInVar - 1 } });
                    colOffset += questionsInVar;
                });
                colOffset = 1;
                dimensionsMap.forEach(dim => {
                     if (dim.questions > 1) merges.push({ s: { r: 1, c: colOffset }, e: { r: 1, c: colOffset + dim.questions - 1 } });
                    colOffset += dim.questions;
                });
                ws['!merges'] = merges;
                
                let colOffsetVar = 1;
                const varHeader = [null];
                variablesConfig.forEach(v => {
                    const questionsInVar = v.dimensions.reduce((acc, dim) => acc + dim.questions, 0);
                    varHeader.push(`Variable ${v.id}`);
                    if (questionsInVar > 1) varHeader.push(...Array(questionsInVar - 1).fill(null));
                });
                
                const dimHeader = [null];
                dimensionsMap.forEach(dim => {
                    dimHeader.push(`Dimensión ${dim.id}`);
                    if (dim.questions > 1) dimHeader.push(...Array(dim.questions - 1).fill(null));
                });

                const headerRows = [varHeader, dimHeader];
                XLSX.utils.sheet_add_aoa(ws, headerRows, { origin: 'A1' });
                
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "Datos de Encuesta");
                XLSX.writeFile(wb, "datos_encuesta.xlsx");
            };

            return (
                <div className="space-y-6">
                    {showResetModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                            <div className="bg-white p-6 rounded-lg shadow-xl text-center">
                                <h3 className="text-lg font-bold mb-4">¿Confirmar Reinicio?</h3>
                                <p className="text-gray-600 mb-6">Perderás todos los datos ingresados. ¿Estás seguro?</p>
                                <div className="flex justify-center gap-4">
                                    <button onClick={() => setShowResetModal(false)} className="py-2 px-4 bg-gray-200 hover:bg-gray-300 rounded-lg">Cancelar</button>
                                    <button onClick={() => { onBackToConfig(); setShowResetModal(false); }} className="py-2 px-4 bg-red-600 hover:bg-red-700 text-white rounded-lg">Sí, reiniciar</button>
                                </div>
                            </div>
                        </div>
                    )}
                    <header className="flex flex-wrap items-center justify-between gap-4">
                        <div className="flex items-center gap-4">
                           <img src="logo_final.png" alt="Logo Institucional" className="h-12 w-auto" style={{display:'block',maxWidth:'180px',maxHeight:'60px',minWidth:'40px',minHeight:'20px',background:'#fff',border:'2px solid #ccc'}} />
                           <div>
                                <h1 className="text-2xl sm:text-3xl font-bold text-gray-900">Herramienta de Vaciado de Datos</h1>
                                <p className="text-gray-500">Edita los datos y visualiza el resumen en tiempo real.</p>
                           </div>
                        </div>
                        <div className="flex items-center gap-2 sm:gap-3 flex-wrap">
                             <button onClick={() => fileInputRef.current.click()} className="flex items-center gap-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded-lg transition-all">
                                Subir Excel
                            </button>
                            <input type="file" ref={fileInputRef} onChange={handleFileUpload} accept=".xlsx, .csv" style={{ display: 'none' }} />
                            <button onClick={handleDownloadExcel} className="flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-all">
                                Descargar
                            </button>
                             <button onClick={() => setShowResetModal(true)} className="flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg transition-all">
                                Reiniciar
                            </button>
                        </div>
                    </header>

                    <div className="grid grid-cols-1 xl:grid-cols-2 gap-6">
                        <div className="bg-white p-4 rounded-xl shadow-md border border-gray-200">
                           <h2 className="text-xl font-bold mb-4">Tabla de Datos</h2>
                            <SurveyTable
                                variablesConfig={variablesConfig}
                                dimensionsMap={dimensionsMap}
                                respondentsData={respondentsData}
                                onDataChange={handleDataChange}
                                onDeleteRespondent={handleDeleteRespondent}
                            />
                            <div className="mt-4 flex items-center gap-2">
                                <input 
                                  type="number"
                                  min="1"
                                  value={respondentsToAdd}
                                  onChange={(e) => setRespondentsToAdd(parseInt(e.target.value, 10))}
                                  className="w-24 bg-gray-50 border-gray-300 text-gray-900 rounded-md p-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                />
                                <button onClick={handleAddRespondents} className="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-all">
                                    Agregar Encuestado(s)
                                </button>
                            </div>
                        </div>

                        <div className="bg-white p-4 rounded-xl shadow-md border border-gray-200">
                            <div className="flex justify-between items-center mb-4">
                               <h2 className="text-xl font-bold">Resumen ({summaryMode === 'average' ? 'Promedios' : 'Sumas'})</h2>
                               <select value={summaryMode} onChange={(e) => setSummaryMode(e.target.value)} className="bg-gray-50 border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-blue-500">
                                   <option value="average">Promedio</option>
                                   <option value="sum">Suma</option>
                               </select>
                           </div>
                            <SummaryTable
                                variablesConfig={variablesConfig}
                                dimensionsMap={dimensionsMap}
                                summaryData={summaryData}
                            />
                        </div>
                    </div>
                </div>
            );
        }
        
        function SurveyTable({ variablesConfig, dimensionsMap, respondentsData, onDataChange, onDeleteRespondent }) {
            const [focusedCell, setFocusedCell] = useState(null);

            const handleKeyDown = (e, respondentId, currentKey) => {
                // Implementación de navegación con teclado (simplificada por brevedad)
            };
            
            return (
                 <div className="table-container">
                    <table className="w-full text-sm text-left text-gray-600 border-collapse">
                        <thead className="text-xs text-gray-700 uppercase bg-gray-100 sticky top-0 z-10">
                            <tr>
                                <th rowSpan="3" className="px-4 py-3 border border-gray-200 text-center sticky left-0 bg-gray-100">Encuestado #</th>
                                {variablesConfig.map(variable => {
                                    const totalQuestionsInVar = variable.dimensions.reduce((sum, dim) => sum + dim.questions, 0);
                                    return (
                                        <th key={variable.id} colSpan={totalQuestionsInVar} className="px-4 py-2 border border-gray-200 text-center">
                                            Variable {variable.id}
                                        </th>
                                    );
                                })}
                                <th rowSpan="3" className="px-2 py-3 border border-gray-200 text-center sticky right-0 bg-gray-100">Acción</th>
                            </tr>
                            <tr>
                                {dimensionsMap.map(dim => (
                                    <th key={dim.id} colSpan={dim.questions} className="px-4 py-2 border border-gray-200 text-center bg-gray-100/70">
                                        Dimensión {dim.id}
                                    </th>
                                ))}
                            </tr>
                            <tr>
                                {dimensionsMap.flatMap(dim => (
                                    Array.from({ length: dim.questions }, (_, i) => (
                                        <th key={`${dim.id}-${i}`} className="px-4 py-2 border border-gray-200 text-center">
                                            P{dim.questionStartIndex + i}
                                        </th>
                                    ))
                                ))}
                            </tr>
                        </thead>
                        <tbody>
                            {respondentsData.map((respondent, index) => (
                                <tr key={respondent.id} className="border-b border-gray-200 odd:bg-white even:bg-gray-50">
                                    <td className="px-4 py-1 border border-gray-200 text-center sticky left-0 font-medium odd:bg-white even:bg-gray-50">{index + 1}</td>
                                    {dimensionsMap.flatMap(dim => {
                                        return Array.from({ length: dim.questions }, (_, i) => {
                                            const questionNumber = dim.questionStartIndex + i;
                                            const key = `d${dim.id}_p${questionNumber}`;
                                            const isFocused = focusedCell === `${respondent.id}-${key}`;
                                            return (
                                                <td key={key} className={`p-0 border border-gray-200 ${isFocused ? 'cell-focus' : ''}`}>
                                                    <input
                                                        id={`cell-${respondent.id}-${key}`}
                                                        type="number"
                                                        min="0"
                                                        value={respondent[key] ?? ''}
                                                        onChange={(e) => onDataChange(respondent.id, key, e.target.value)}
                                                        onFocus={(e) => { setFocusedCell(`${respondent.id}-${key}`); e.target.select(); }}
                                                        onBlur={() => setFocusedCell(null)}
                                                        onKeyDown={(e) => handleKeyDown(e, respondent.id, key)}
                                                        className="w-full h-full bg-transparent text-center p-2 outline-none"
                                                    />
                                                </td>
                                            );
                                        });
                                    })}
                                    <td className="px-2 py-1 border border-gray-200 text-center sticky right-0 odd:bg-white even:bg-gray-50">
                                        <button onClick={() => onDeleteRespondent(respondent.id)} className="text-red-500 hover:text-red-700 transition-colors">
                                            <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                                <path fillRule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z" clipRule="evenodd" />
                                            </svg>
                                        </button>
                                    </td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>
            );
        }

        function SummaryTable({ variablesConfig, dimensionsMap, summaryData }) {
            return (
                <div className="table-container">
                    <table className="w-full text-sm text-left text-gray-600 border-collapse">
                        <thead className="text-xs text-gray-700 uppercase bg-gray-100 sticky top-0 z-10">
                            <tr>
                                <th className="px-4 py-2 border border-gray-200 text-center">Encuestado #</th>
                                {variablesConfig.map(variable => (
                                    <th key={`var-header-${variable.id}`} className="px-4 py-2 border border-gray-200 text-center">
                                        Variable {variable.id}
                                    </th>
                                ))}
                                {dimensionsMap.map(dim => (
                                    <th key={`dim-header-${dim.id}`} className="px-4 py-2 border border-gray-200 text-center whitespace-nowrap">
                                        Dimensión {dim.id}
                                    </th>
                                ))}
                            </tr>
                        </thead>
                        <tbody>
                            {summaryData.map((summary, index) => {
                                return (
                                    <tr key={summary.respondentId} className="border-b border-gray-200 odd:bg-white even:bg-gray-50">
                                        <td className="px-4 py-2 border border-gray-200 text-center font-medium">{index + 1}</td>
                                        {/* Variable Data */}
                                        {variablesConfig.map(variable => (
                                            <td key={`var-data-${summary.respondentId}-${variable.id}`} className="px-4 py-2 border border-gray-200 text-center font-semibold text-blue-600">
                                                {summary?.variables?.[`var_${variable.id}`] ?? 'N/A'}
                                            </td>
                                        ))}
                                        {/* Dimension Data */}
                                        {dimensionsMap.map(dim => (
                                            <td key={`dim-data-${summary.respondentId}-${dim.id}`} className="px-4 py-2 border border-gray-200 text-center font-semibold text-blue-600">
                                                {summary?.dimensions?.[`dim_${dim.id}`] ?? 'N/A'}
                                            </td>
                                        ))}
                                    </tr>
                                );
                            })}
                        </tbody>
                    </table>
                </div>
            );
        }

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>

